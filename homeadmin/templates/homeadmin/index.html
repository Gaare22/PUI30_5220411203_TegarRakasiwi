{% load static %}
<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>TRLearn</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- bootstrap css -->
      <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
      <!-- style css -->
      <link rel="stylesheet" href="{% static 'css/style.css' %}">
      <!-- Responsive-->
      <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
      <!-- fevicon -->
      <link rel="icon" href="{% static 'img/gabel_logo1.png' %}" type="image/gif" />
      <!-- Tweaks for older IEs-->
      <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
      <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->

     
   </head>
   <!-- body -->
   <body class="main-layout">
      <!-- header -->
      <div class="header">
         <div class="container-fluid">
            <div class="row d_flex">
               <div class=" col-md-2 col-sm-3 col logo_section">
                  <div class="full">
                     <div class="center-desk">
                        <div class="logo">
                           <a href="/"><img src="{% static 'img/gabel_logo1.png' %}" alt="#" /></a>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-md-10 col-sm-12">
                  <nav class="navigation navbar navbar-expand-md navbar-dark ">
                     <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04"
                        aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                     </button>
                     <div class="collapse navbar-collapse" id="navbarsExample04">
                        <ul class="navbar-nav mr-auto">
                           <li class="nav-item">
                              <a class="nav-link active" href="/homeadmin/">Dashboard</a>
                           </li>
                           <li class="nav-item">
                              <a class="nav-link" href="/info_data/">Data</a>
                           </li>
                           <li class="nav-item">
                              <a class="nav-link" href="/input_data/">Input Data</a>
                           </li>
                           <li class="nav-item">
                              <a class="nav-link" href="/pelatihan/">Pelatihan</a>
                           </li>
                           <li class="nav-item">
                              <a class="nav-link" href="/pengujian/">Pengujian</a>
                           </li>
                           <li class="nav-item">
                              <a class="nav-link" href="/prediksi_admin/">Prediksi</a>
                           </li>
                        </ul>

                        <!-- Logout otomatis ke kanan -->
                        <ul class="navbar-nav ml-auto">
                           <li class="nav-item">
                              <a class="nav-link" href="/">Logout</a>
                           </li>
                        </ul>
                     </div>
                  </nav>
               </div>

            </div>
         </div>
      </div>
      <!-- end header inner -->
      <!-- end header -->
      <!-- top -->
      <div class="full_bg">
         <div class="slider_main">
            <div class="container-fluid">
               <div class="row">
                  <div class="col-md-12">
                     
                     <div class="container mt-5">
                        <h2 class="text-center mb-4">Dashboard Data</h2>
                        <!-- Pelatihan -->
                        <div class="row text-center">
                           <!-- Grafik Batang -->
                           <div class="col-md-4 d-flex flex-column align-items-center">
                              <h5>Distribusi Jenis Kelamin Data Pelatihan</h5>
                              <hr style="width: 100%;">
                              <div class="d-flex justify-content-center align-items-center">
                                 <canvas style="width: 180px; height: 180px;" id="genderChart"></canvas>
                              </div>
                           </div>

                           <!-- Grafik Pie -->
                           <div class="col-md-4 d-flex flex-column align-items-center">
                              <h5>Distribusi Gaya Belajar Data Pelatihan</h5>
                              <hr style="width: 100%;">
                              <div class="d-flex justify-content-center align-items-center">
                                 <canvas style="width: 180px; height: 180px;" id="gayaChart"></canvas>
                              </div>
                           </div>

                           <!-- Grafik Jurusan -->
                           <div class="col-md-4 d-flex flex-column align-items-center">
                              <h5>Distribusi Jurusan Data Pelatihan</h5>
                              <hr style="width: 100%;">
                              <div class="d-flex justify-content-center align-items-center">
                                 <canvas style="width: 180px; height: 180px;" id="jurusanChart"></canvas>
                              </div>
                           </div>
                        </div>

                        <!-- Prediksi -->
                        <div class="row text-center mt-5">
                           <!-- Grafik Batang -->
                           <div class="col-md-4 d-flex flex-column align-items-center">
                              <h5>Distribusi Jenis Kelamin Data Prediksi</h5>
                              <hr style="width: 100%;">
                              <div class="d-flex justify-content-center align-items-center">
                                 <canvas style="width: 180px; height: 180px;" id="genderChart2"></canvas>
                              </div>
                           </div>

                           <!-- Grafik Pie -->
                           <div class="col-md-4 d-flex flex-column align-items-center">
                              <h5>Distribusi Gaya Belajar Data Prediksi</h5>
                              <hr style="width: 100%;">
                              <div class="d-flex justify-content-center align-items-center">
                                 <canvas style="width: 180px; height: 180px;" id="gayaChart2"></canvas>
                              </div>
                           </div>

                           <!-- Grafik Jurusan -->
                           <div class="col-md-4 d-flex flex-column align-items-center">
                              <h5>Distribusi Jurusan Data Prediksi</h5>
                              <hr style="width: 100%;">
                              <div class="d-flex justify-content-center align-items-center">
                                 <canvas style="width: 180px; height: 180px;" id="jurusanChart2"></canvas>
                              </div>
                           </div>
                        </div>
                     </div>

                  </div>
               </div>
            </div>
         </div>
      </div>
      <!-- end banner -->
      
      <!-- end footer -->
      <!-- Javascript files-->
      <script src="{% static 'js/jquery.min.js' %}"></script>
      <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
      <script src="{% static 'js/jquery-3.0.0.min.js' %}"></script>
      <!-- sidebar -->
      <script src="{% static 'js/custom.js' %}"></script>

      {{ gender_labels_pel|json_script:"gender-labels-pel" }}
      {{ gender_data_pel|json_script:"gender-data-pel" }}
      {{ gaya_labels_pel|json_script:"gaya-labels-pel" }}
      {{ gaya_data_pel|json_script:"gaya-data-pel" }}
      {{ jurusan_labels_pel|json_script:"jurusan-labels-pel" }}
      {{ jurusan_data_pel|json_script:"jurusan-data-pel" }}
      {{ gender_labels_pred|json_script:"gender-labels-pred" }}
      {{ gender_data_pred|json_script:"gender-data-pred" }}
      {{ gaya_labels_pred|json_script:"gaya-labels-pred" }}
      {{ gaya_data_pred|json_script:"gaya-data-pred" }}
      {{ jurusan_labels_pred|json_script:"jurusan-labels-pred" }}
      {{ jurusan_data_pred|json_script:"jurusan-data-pred" }}

      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script>
         // Ambil data dari Django (JSON valid)
         const genderLabelsPel = JSON.parse(document.getElementById('gender-labels-pel').textContent);
         const genderDataPel   = JSON.parse(document.getElementById('gender-data-pel').textContent);
         const gayaLabelsPel   = JSON.parse(document.getElementById('gaya-labels-pel').textContent);
         const gayaDataPel     = JSON.parse(document.getElementById('gaya-data-pel').textContent);
         const jurusanLabelsPel = JSON.parse(document.getElementById('jurusan-labels-pel').textContent);
         const jurusanDataPel   = JSON.parse(document.getElementById('jurusan-data-pel').textContent);
         const genderLabelsPred = JSON.parse(document.getElementById('gender-labels-pred').textContent);
         const genderDataPred   = JSON.parse(document.getElementById('gender-data-pred').textContent);
         const gayaLabelsPred   = JSON.parse(document.getElementById('gaya-labels-pred').textContent);
         const gayaDataPred     = JSON.parse(document.getElementById('gaya-data-pred').textContent);
         const jurusanLabelsPred = JSON.parse(document.getElementById('jurusan-labels-pred').textContent);
         const jurusanDataPred   = JSON.parse(document.getElementById('jurusan-data-pred').textContent);

         //Pelatihan Charts
         // Bar chart - Gender
         new Chart(document.getElementById('genderChart'), {
            type: 'bar',
            data: {
               labels: genderLabelsPel,
               datasets: [{
                     label: 'Jumlah',
                     data: genderDataPel,
                     backgroundColor: ['#C77DFF','#5A198A'],
                     borderWidth: 1
               }]
            },
            options: {
               responsive: true,
               plugins: {
                     legend: { display: false } // sembunyikan penunjuk warna
               },
               scales: { y: { beginAtZero: true } }
            }
         });

         // Pie chart - Gaya Belajar
         new Chart(document.getElementById('gayaChart'), {
            type: 'pie',
            data: {
               labels: gayaLabelsPel,
               datasets: [{
                     data: gayaDataPel,
                     backgroundColor: ['#FF6384','#36A2EB','#FFCE56','#4BC0C0','#9966FF'],
               }]
            },
            options: {
               responsive: true,
               plugins: {
                  legend: {
                     display: true,
                     position: 'top',
                     labels: {
                        boxWidth: 15,     // kecilkan kotak warna
                        padding: 10
                     }
                  }
               }
            }
         });

         // Jurusan (Pie - warna random, legend hidden)
         const randomColors = jurusanLabelsPel.map(() =>
            `hsl(${Math.floor(Math.random() * 360)}, 70%, 60%)`
         );

         new Chart(document.getElementById('jurusanChart'), {
            type: 'pie',
            data: {
               labels: jurusanLabelsPel,
               datasets: [{
                     data: jurusanDataPel,
                     backgroundColor: randomColors,
               }]
            },
            options: {
               responsive: true,             
               plugins: {
                     legend: { display: false } // sembunyikan penunjuk warna
               }
            }
         });

         //Prediksi Charts
         // Bar chart - Gender
         new Chart(document.getElementById('genderChart2'), {
            type: 'bar',
            data: {
               labels: genderLabelsPred,
               datasets: [{
                     label: 'Jumlah',
                     data: genderDataPred,
                     backgroundColor: ['#C77DFF','#5A198A'],
                     borderWidth: 1
               }]
            },
            options: {
               responsive: true,
               plugins: {
                     legend: { display: false } // sembunyikan penunjuk warna
               },
               scales: { y: { beginAtZero: true } }
            }
         });

         // Pie chart - Gaya Belajar
         new Chart(document.getElementById('gayaChart2'), {
            type: 'pie',
            data: {
               labels: gayaLabelsPred,
               datasets: [{
                     data: gayaDataPred,
                     backgroundColor: ['#FF6384','#36A2EB','#FFCE56','#4BC0C0','#9966FF'],
               }]
            },
            options: {
               responsive: true,
               plugins: {
                  legend: {
                     display: true,
                     position: 'top',
                     labels: {
                        boxWidth: 15,     // kecilkan kotak warna
                        padding: 10
                     }
                  }
               }
            }
         });

         // Jurusan (Pie - warna random, legend hidden)
         const randomColors2 = jurusanLabelsPred.map(() =>
            `hsl(${Math.floor(Math.random() * 360)}, 70%, 60%)`
         );

         new Chart(document.getElementById('jurusanChart2'), {
            type: 'pie',
            data: {
               labels: jurusanLabelsPred,
               datasets: [{
                     data: jurusanDataPred,
                     backgroundColor: randomColors2,
               }]
            },
            options: {
               responsive: true,             
               plugins: {
                     legend: { display: false } // sembunyikan penunjuk warna
               }
            }
         });
      </script>
   </body>
</html>